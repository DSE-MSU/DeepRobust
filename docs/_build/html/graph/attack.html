<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Introduction to Graph Attack with Examples &mdash; DeepRobust 0.1.1 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Introduction to Graph Defense with Examples" href="defense.html" />
    <link rel="prev" title="Graph Dataset" href="data.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> DeepRobust
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notes/installation.html">Installation</a></li>
</ul>
<p><span class="caption-text">Graph Package</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="data.html">Graph Dataset</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction to Graph Attack with Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#global-untargeted-attack-for-node-classification">Global (Untargeted) Attack for Node Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#targeted-attack-for-node-classification">Targeted Attack for Node Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#more-examples">More Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="defense.html">Introduction to Graph Defense with Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyg.html">Using PyTorch Geometric in DeepRobust</a></li>
<li class="toctree-l1"><a class="reference internal" href="node_embedding.html">Node Embedding Attack and Defense</a></li>
</ul>
<p><span class="caption-text">Image Package</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../image/attack.html">Introduction to Image Attack with Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../image/defense.html">Introduction to Image Defense with Examples</a></li>
</ul>
<p><span class="caption-text">Image Package</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/deeprobust.image.attack.html">deeprobust.image.attack package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/deeprobust.image.defense.html">deeprobust.image.defense package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/deeprobust.image.netmodels.html">deeprobust.image.netmodels package</a></li>
</ul>
<p><span class="caption-text">Graph Package</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/deeprobust.graph.global_attack.html">deeprobust.graph.global_attack package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/deeprobust.graph.targeted_attack.html">deeprobust.graph.targeted_attack package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/deeprobust.graph.defense.html">deeprobust.graph.defense package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/deeprobust.graph.data.html">deeprobust.graph.data package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DeepRobust</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Introduction to Graph Attack with Examples</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/graph/attack.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="introduction-to-graph-attack-with-examples">
<h1>Introduction to Graph Attack with Examples<a class="headerlink" href="#introduction-to-graph-attack-with-examples" title="Permalink to this headline">¶</a></h1>
<p>In this section, we introduce the graph attack algorithms provided
in DeepRobust. Speficailly, they can be divied into two types:
(1) targeted attack <code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.targeted_attack</span></code>  and
(2) global attack <code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.global_attack</span></code>.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#global-untargeted-attack-for-node-classification" id="id1">Global (Untargeted) Attack for Node Classification</a></p></li>
<li><p><a class="reference internal" href="#targeted-attack-for-node-classification" id="id2">Targeted Attack for Node Classification</a></p></li>
<li><p><a class="reference internal" href="#more-examples" id="id3">More Examples</a></p></li>
</ul>
</div>
<section id="global-untargeted-attack-for-node-classification">
<h2><a class="toc-backref" href="#id1">Global (Untargeted) Attack for Node Classification</a><a class="headerlink" href="#global-untargeted-attack-for-node-classification" title="Permalink to this headline">¶</a></h2>
<p>Global (untargeted) attack aims to fool GNNs into giving wrong predictions on all
given nodes. Specifically, DeepRobust provides the following targeted
attack algorithms:</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.global_attack.Metattack</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.global_attack.MetaApprox</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.global_attack.DICE</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.global_attack.MinMax</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.global_attack.PGDAttack</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.global_attack.NIPA</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.global_attack.Random</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.global_attack.NodeEmbeddingAttack</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.global_attack.OtherNodeEmbeddingAttack</span></code></p></li>
</ul>
<p>All the above attacks except <cite>NodeEmbeddingAttack</cite> and <cite>OtherNodeEmbeddingAttack</cite> (see details
<a class="reference external" href="https://deeprobust.readthedocs.io/en/latest/graph/node_embedding.html">here</a> )
take the adjacency matrix, node feature matrix and labels as input. Usually, the adjacency
matrix is in the format of <code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code> and feature matrix can either be
<code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.array</span></code>. The attack algorithm
will then transfer them into <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.tensor</span></code> inside the class. It is also fine if you
provide <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.tensor</span></code> as input, since the algorithm can automatically deal with it.
Now let’s take a look at an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">deeprobust.graph.data</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">deeprobust.graph.defense</span> <span class="kn">import</span> <span class="n">GCN</span>
<span class="kn">from</span> <span class="nn">deeprobust.graph.global_attack</span> <span class="kn">import</span> <span class="n">Metattack</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;/tmp/&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">)</span>
<span class="n">adj</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">adj</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">labels</span>
<span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_val</span><span class="p">,</span> <span class="n">idx_test</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">idx_train</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">idx_val</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">idx_test</span>
<span class="n">idx_unlabeled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">union1d</span><span class="p">(</span><span class="n">idx_val</span><span class="p">,</span> <span class="n">idx_test</span><span class="p">)</span>
<span class="n">idx_unlabeled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">union1d</span><span class="p">(</span><span class="n">idx_val</span><span class="p">,</span> <span class="n">idx_test</span><span class="p">)</span>
<span class="c1"># Setup Surrogate model</span>
<span class="n">surrogate</span> <span class="o">=</span> <span class="n">GCN</span><span class="p">(</span><span class="n">nfeat</span><span class="o">=</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nclass</span><span class="o">=</span><span class="n">labels</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">nhid</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">with_relu</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
<span class="n">surrogate</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">adj</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_val</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="c1"># Setup Attack Model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Metattack</span><span class="p">(</span><span class="n">surrogate</span><span class="p">,</span> <span class="n">nnodes</span><span class="o">=</span><span class="n">adj</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">feature_shape</span><span class="o">=</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
        <span class="n">attack_structure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">attack_features</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
<span class="c1"># Attack</span>
<span class="n">model</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">adj</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_unlabeled</span><span class="p">,</span> <span class="n">n_perturbations</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ll_constraint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">modified_adj</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">modified_adj</span> <span class="c1"># modified_adj is a torch.tensor</span>
</pre></div>
</div>
</section>
<section id="targeted-attack-for-node-classification">
<h2><a class="toc-backref" href="#id2">Targeted Attack for Node Classification</a><a class="headerlink" href="#targeted-attack-for-node-classification" title="Permalink to this headline">¶</a></h2>
<p>Targeted attack aims to fool GNNs into give wrong predictions on a
subset of nodes. Specifically, DeepRobust provides the following targeted
attack algorithms:</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.targeted_attack.Nettack</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.targeted_attack.RLS2V</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.targeted_attack.FGA</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.targeted_attack.RND</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.targeted_attack.IGAttack</span></code></p></li>
</ul>
<p>All the above attacks take the adjacency matrix, node feature matrix and labels as input.
Usually, the adjacency matrix is in the format of <code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code> and feature
matrix can either be <code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.array</span></code>. Now let’s take a look at an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">deeprobust.graph.data</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">deeprobust.graph.defense</span> <span class="kn">import</span> <span class="n">GCN</span>
<span class="kn">from</span> <span class="nn">deeprobust.graph.targeted_attack</span> <span class="kn">import</span> <span class="n">Nettack</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;/tmp/&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cora&#39;</span><span class="p">)</span>
<span class="n">adj</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">adj</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">labels</span>
<span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_val</span><span class="p">,</span> <span class="n">idx_test</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">idx_train</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">idx_val</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">idx_test</span>
<span class="c1"># Setup Surrogate model</span>
<span class="n">surrogate</span> <span class="o">=</span> <span class="n">GCN</span><span class="p">(</span><span class="n">nfeat</span><span class="o">=</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nclass</span><span class="o">=</span><span class="n">labels</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">nhid</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">with_relu</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
<span class="n">surrogate</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">adj</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_val</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="c1"># Setup Attack Model</span>
<span class="n">target_node</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Nettack</span><span class="p">(</span><span class="n">surrogate</span><span class="p">,</span> <span class="n">nnodes</span><span class="o">=</span><span class="n">adj</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">attack_structure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">attack_features</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
<span class="c1"># Attack</span>
<span class="n">model</span><span class="o">.</span><span class="n">attack</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">adj</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">target_node</span><span class="p">,</span> <span class="n">n_perturbations</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">modified_adj</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">modified_adj</span> <span class="c1"># scipy sparse matrix</span>
<span class="n">modified_features</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">modified_features</span> <span class="c1"># scipy sparse matrix</span>
</pre></div>
</div>
<p>Note that we also provide scripts in <a class="reference download external" download="" href="https://github.com/DSE-MSU/DeepRobust/blob/master/examples/graph/test_nettack.py"><code class="xref download docutils literal notranslate"><span class="pre">test_nettack.py</span></code></a>
for selecting nodes as reported in the
<a class="reference external" href="https://arxiv.org/abs/1805.07984">nettack</a> paper: (1) the 10 nodes
with highest margin of classification, i.e. they are clearly correctly classified,
(2) the 10 nodes with lowest margin (but still correctly classified) and
(3) 20 more nodes randomly.</p>
</section>
<section id="more-examples">
<h2><a class="toc-backref" href="#id3">More Examples</a><a class="headerlink" href="#more-examples" title="Permalink to this headline">¶</a></h2>
<p>More examples can be found in <code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.targeted_attack</span></code> and
<code class="xref py py-class docutils literal notranslate"><span class="pre">deeprobust.graph.global_attack</span></code>. You can also find examples in
<a class="reference external" href="https://github.com/DSE-MSU/DeepRobust/tree/master/examples/graph">github code examples</a>
and more details in <a class="reference external" href="https://github.com/DSE-MSU/DeepRobust/tree/master/deeprobust/graph#attack-methods">attacks table</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="data.html" class="btn btn-neutral float-left" title="Graph Dataset" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="defense.html" class="btn btn-neutral float-right" title="Introduction to Graph Defense with Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>